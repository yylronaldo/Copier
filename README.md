# Copier - 跨平台剪贴板同步工具

Copier 是一个基于 MQTT 的跨平台剪贴板同步工具，支持 Windows 和 macOS 系统。它提供了强大的剪贴板内容管理和同步功能，支持文本和图片的实时同步。

## 功能特点

### 剪贴板同步
- 实时监控系统剪贴板变化
- 通过 MQTT 在多台设备间同步剪贴板内容
- 支持文本和图片内容的同步
- 使用 zstandard 压缩传输数据，提高同步效率

### 用户界面
- 现代化的深色主题界面
- 系统托盘运行，支持后台监听
- 双击托盘图标快速显示/隐藏窗口
- 历史记录列表显示剪贴板内容
- 文本和图片的实时预览

### 内容管理
- 智能的内容预览（文本自动截断，图片自动缩放）
- 历史记录按时间排序
- 双击复制功能，带有点击次数统计
- 图片预览支持时间戳显示
- 支持最近50条历史记录

## 技术栈

- **GUI 框架**: PySide6 (Qt for Python)
- **通信协议**: MQTT (paho-mqtt)
- **数据处理**:
  - zstandard: 数据压缩
  - Pillow: 图片处理
  - JSON: 配置文件管理
- **系统集成**: 
  - pyperclip: 剪贴板操作
  - 系统托盘集成

## 工作原理

1. **剪贴板监听**:
   - 使用定时器定期检查剪贴板变化
   - 支持文本和图片格式
   - 智能去重避免重复记录

2. **数据同步**:
   - 通过 MQTT 协议进行设备间通信
   - 使用 zstandard 压缩传输数据
   - 支持断线重连和自动重试

3. **内容管理**:
   - 使用 LRU 策略管理历史记录
   - 智能的内容预览和缩略图生成
   - 双击复制时的智能计数

## 使用说明

### 安装
1. 安装依赖包：
```bash
pip install -r requirements.txt
```

### 配置
1. 首次运行时会创建 `config.json` 配置文件
2. 配置项说明：
   - `mqtt_host`: MQTT 服务器地址
   - `mqtt_port`: MQTT 服务器端口
   - `mqtt_username`: MQTT 用户名（可选）
   - `mqtt_password`: MQTT 密码（可选）
   - `mqtt_topic_prefix`: MQTT 主题前缀

### 运行
1. 启动程序：
```bash
python main.py
```

2. 使用方法：
   - 程序启动后会在系统托盘显示图标
   - 双击托盘图标显示/隐藏主窗口
   - 复制文本或图片会自动同步到其他设备
   - 双击历史记录项可以快速复制内容
   - 右键托盘图标可以访问快捷菜单

### 快捷操作
- **复制内容**: 正常使用系统复制功能即可
- **查看历史**: 点击主窗口显示历史记录
- **快速复制**: 双击历史记录项
- **预览内容**: 单击历史记录项查看预览
- **退出程序**: 右键托盘图标选择"退出"

## 注意事项

- 确保所有设备能够访问到同一个 MQTT 服务器
- 建议使用私有 MQTT 服务器以保护数据安全
- 如需在内网使用，请确保 MQTT 服务器在内网可访问
- 图片同步时会自动压缩以提高传输效率
- 历史记录最多保存50条，超出会自动删除最早的记录

## 更新日志

### v1.0.0
- 实现基础的文本同步功能
- 添加 MQTT 配置支持
- 实现系统托盘集成

### v2.0.0
- 添加图片同步支持
- 实现数据压缩传输
- 优化用户界面
- 添加历史记录功能
- 实现双击复制计数
- 添加时间戳显示
- 优化预览功能
